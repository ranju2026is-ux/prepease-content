<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrepEase | Karnataka & SSC English Master</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #ffffff; color: #0f172a; scroll-behavior: smooth; overflow-x: hidden; }
        .glass-card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(14px); border: 1px solid rgba(14, 165, 233, 0.1); }
        .level-locked { filter: grayscale(1); opacity: 0.4; cursor: not-allowed !important; }
        .transition-all { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .hidden { display: none !important; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f8fafc; }
        ::-webkit-scrollbar-thumb { background: #0ea5e9; border-radius: 10px; }
        
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-page { animation: slideUp 0.6s ease-out forwards; }
        
        .hero-gradient {
            background: radial-gradient(circle at top right, rgba(14, 165, 233, 0.08), transparent),
                        radial-gradient(circle at bottom left, rgba(16, 185, 129, 0.05), transparent);
        }

        .btn-primary { @apply px-10 py-5 bg-sky-500 text-white font-extrabold rounded-[2rem] shadow-2xl shadow-sky-200 hover:-translate-y-1 active:scale-95 transition-all cursor-pointer; }
        .btn-secondary { @apply px-10 py-5 bg-white border-2 border-slate-100 text-slate-600 font-extrabold rounded-[2rem] hover:bg-slate-50 hover:-translate-y-1 active:scale-95 transition-all cursor-pointer; }
        
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        .float-anim { animation: float 4s ease-in-out infinite; }

        .progress-ring { transform: rotate(-90deg); transform-origin: 50% 50%; }

        /* FLASHCARD 3D CSS */
        .flashcard-container { perspective: 1000px; width: 100%; max-width: 450px; height: 500px; }
        .flashcard-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; cursor: pointer; }
        .flashcard-inner.is-flipped { transform: rotateY(180deg); }
        .flashcard-front, .flashcard-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; border-radius: 2.5rem; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 2.5rem; border: 4px solid #f0f9ff; background: white; box-shadow: 0 25px 50px -12px rgba(14, 165, 233, 0.1); }
        .flashcard-back { transform: rotateY(180deg); border-color: #0ea5e9; }
    </style>
</head>
<body class="bg-white">

    <div id="moto-bar" class="sticky top-0 z-50 bg-slate-900 text-white py-3 text-center text-xs md:text-sm font-medium tracking-wide shadow-xl border-b border-white/10">
        <span id="moto-text" class="opacity-100 transition-opacity duration-500">Karnataka's #1 Destination for English Aspirants üèÜ</span>
    </div>

    <nav class="border-b border-slate-50 py-5 px-6 md:px-12 flex justify-between items-center bg-white/90 sticky top-[44px] z-40 backdrop-blur-xl">
        <div onclick="showView('landing')" class="flex items-center gap-3 cursor-pointer group">
            <div class="w-10 h-10 bg-sky-500 rounded-xl flex items-center justify-center text-white font-extrabold text-xl shadow-lg shadow-sky-200 group-hover:rotate-6 transition-all">P</div>
            <span class="text-2xl font-extrabold text-slate-900 tracking-tighter text-shadow-sm">PrepEase</span>
        </div>
        <div id="nav-actions" class="flex items-center gap-6">
            <button onclick="showView('dashboard')" class="text-sm font-bold text-slate-600 hover:text-sky-500 transition-all">Dashboard</button>
        </div>
    </nav>

    <!-- SPA SECTIONS -->
    <section id="landing-page" class="animate-page">
        <div class="hero-gradient min-h-screen">
            <div class="max-w-6xl mx-auto px-6 pt-24 pb-32 text-center lg:text-left">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-20 items-center">
                    <div>
                        <h1 class="text-7xl md:text-8xl font-extrabold text-slate-900 leading-[0.85] mb-8 tracking-tighter">
                            Step by step. <br><span class="text-sky-500">Government Rank.</span>
                        </h1>
                        <p class="text-xl text-slate-500 leading-relaxed mb-12 max-w-lg mx-auto lg:mx-0">
                            The ultimate exam-prep platform for Karnataka's FDA, SDA and Group-C aspirants. Master Grammar & Vocab with ease.
                        </p>
                        <div class="flex flex-col sm:flex-row gap-5 justify-center lg:justify-start">
                            <button onclick="showView('dashboard')" class="btn-primary">Start Learning</button>
                            <button onclick="document.getElementById('features').scrollIntoView({behavior: 'smooth'})" class="btn-secondary">Explore Modules</button>
                        </div>
                    </div>
                    <div class="relative" id="features">
                        <div class="w-full aspect-square glass-card rounded-[4rem] shadow-2xl p-12 flex flex-col justify-center gap-8 float-anim">
                            <div class="flex items-center gap-6">
                                <div class="w-16 h-16 bg-emerald-500 rounded-3xl flex items-center justify-center text-white text-3xl shadow-xl shadow-emerald-100">üá¨üáß</div>
                                <div><p class="text-slate-900 font-bold text-lg">General English</p><p class="text-slate-400 text-sm">Grammar & Vocabulary sync.</p></div>
                            </div>
                            <div class="p-6 bg-slate-900 rounded-[2.5rem] text-white">
                                <p class="text-sky-400 font-bold text-xs uppercase mb-1">Full Access</p>
                                <p class="text-sm opacity-90 italic">All topics now feature 10 progressive levels.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="dashboard-page" class="hidden animate-page">
        <div class="max-w-6xl mx-auto px-6 py-12">
            <!-- OFFICER PROFILE HEADER -->
            <div class="relative p-12 bg-slate-900 rounded-[4rem] overflow-hidden mb-16 shadow-2xl">
                <div class="relative z-10 flex flex-col md:flex-row justify-between items-center gap-10 text-center md:text-left">
                    <div>
                        <span class="text-sky-400 text-xs font-bold uppercase tracking-[0.2em] mb-4 block">Officer Career Roadmap</span>
                        <h2 id="welcome-text" class="text-4xl md:text-5xl font-extrabold text-white mb-4 tracking-tight">Focus & Discipline</h2>
                        <p id="due-count-text" class="text-slate-400 text-lg max-w-md">Consistent study ensures a spot in the selection list.</p>
                    </div>
                    <div class="relative w-40 h-40">
                        <svg class="w-full h-full progress-ring">
                            <circle class="text-slate-800" stroke-width="8" stroke="currentColor" fill="transparent" r="70" cx="80" cy="80"/>
                            <circle id="progress-circle" class="text-sky-500" stroke-width="8" stroke-dasharray="440" stroke-dashoffset="440" stroke-linecap="round" stroke="currentColor" fill="transparent" r="70" cx="80" cy="80"/>
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center text-white">
                            <span id="progress-pct" class="text-3xl font-extrabold">0%</span>
                            <span class="text-[10px] uppercase font-bold tracking-tighter">Overall</span>
                        </div>
                    </div>
                </div>
                <div class="absolute -right-20 -bottom-20 w-80 h-80 bg-sky-500/10 rounded-full blur-[100px]"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                <div onclick="showView('category-select')" class="group p-12 bg-white border border-slate-100 rounded-[3rem] shadow-xl hover:shadow-2xl hover:-translate-y-2 cursor-pointer transition-all">
                    <div class="w-20 h-20 bg-sky-500 rounded-3xl flex items-center justify-center text-white text-4xl mb-8 group-hover:rotate-6 transition-all shadow-lg shadow-sky-200">üá¨üáß</div>
                    <h3 class="text-3xl font-bold mb-3 tracking-tight">General English</h3>
                    <p class="text-slate-500 leading-relaxed">Foundation for KPSC FDA, SDA & Group-C exams.</p>
                    <div class="mt-8 flex items-center gap-2 text-sky-500 font-bold">
                        <span>Open Roadmap</span> <span class="group-hover:translate-x-2 transition-all">‚Üí</span>
                    </div>
                </div>
                <div class="p-12 bg-slate-50 border border-slate-100 rounded-[3rem] opacity-60">
                    <div class="w-20 h-20 bg-slate-200 rounded-3xl flex items-center justify-center text-slate-400 text-4xl mb-8">üìÑ</div>
                    <h3 class="text-3xl font-bold mb-3 text-slate-400 font-bold">Mock Exams</h3>
                    <p class="text-slate-400 leading-relaxed">Full-length previous year papers coming soon.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CATEGORY SELECTION -->
    <section id="category-select-page" class="hidden animate-page">
        <div class="max-w-6xl mx-auto px-6 py-16">
            <button onclick="showView('dashboard')" class="text-slate-400 font-bold mb-8 flex items-center gap-2 hover:text-sky-500 transition-all">‚Üê Back</button>
            <h2 class="text-5xl font-extrabold text-slate-900 mb-12 tracking-tight">English Tracks</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                <div onclick="showView('topic-select', { category: 'grammar' })" class="group p-12 bg-white border border-slate-100 rounded-[3rem] shadow-xl hover:shadow-2xl cursor-pointer transition-all">
                    <div class="w-16 h-16 bg-sky-50 text-sky-500 rounded-2xl flex items-center justify-center text-3xl mb-8">üî°</div>
                    <h3 class="text-3xl font-bold mb-3 text-slate-900">Grammar</h3>
                    <p class="text-slate-500 mb-8 leading-relaxed">Master parts of speech, tenses, and sentence structure.</p>
                    <span class="text-sky-500 font-bold">View Topics ‚Üí</span>
                </div>
                <div onclick="showView('topic-select', { category: 'vocabulary' })" class="group p-12 bg-white border border-slate-100 rounded-[3rem] shadow-xl hover:shadow-2xl cursor-pointer transition-all">
                    <div class="w-16 h-16 bg-sky-50 text-sky-500 rounded-2xl flex items-center justify-center text-3xl mb-8">üìö</div>
                    <h3 class="text-3xl font-bold mb-3 text-slate-900">Vocabulary</h3>
                    <p class="text-slate-500 mb-8 leading-relaxed">High-frequency words and synonyms used in regional exams.</p>
                    <span class="text-sky-500 font-bold">View Topics ‚Üí</span>
                </div>
            </div>
        </div>
    </section>

    <!-- TOPIC SELECTION -->
    <section id="topic-select-page" class="hidden animate-page">
        <div class="max-w-6xl mx-auto px-6 py-16">
            <button onclick="showView('category-select')" class="text-slate-400 font-bold mb-8 flex items-center gap-2 hover:text-sky-500 transition-all">‚Üê Back</button>
            <h2 id="topic-title" class="text-5xl font-extrabold text-slate-900 mb-12 tracking-tight">Select Topic</h2>
            <div id="topics-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </div>
    </section>

    <section id="synonyms-levels-page" class="hidden animate-page">
        <div class="max-w-6xl mx-auto px-6 py-16">
            <button onclick="showView('topic-select')" class="text-slate-400 font-bold mb-8 flex items-center gap-2 hover:text-sky-500 transition-all">‚Üê Topics</button>
            <h2 id="level-selection-title" class="text-4xl font-extrabold text-slate-900 mb-12 tracking-tight">Select Your Level</h2>
            <div id="levels-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </div>
    </section>

    <section id="level-page" class="hidden animate-page"></section>

    <div id="ui-message" class="fixed bottom-10 left-1/2 -translate-x-1/2 z-[100] px-6 py-3 rounded-2xl bg-slate-900 text-white text-sm font-bold shadow-2xl hidden animate-page"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = 'prepease-karnataka-v13';

        // --- BASE PATH CONFIG ---
        const CONTENT_BASE = "./general-english/vocabulary/";

        // --- APP STATE ---
        let currentView = "landing";
        let currentCategory = ""; 
        let currentTopic = ""; 
        let user = null;
        let userProfile = { name: "Aspirant", completedLevels: { 'synonyms': [1,2,3,4] } }; 
        let activeLevelData = null;
        let flashcardSession = { words: [], currentIdx: 0, levelId: null };

        const CATEGORY_TOPICS = {
            grammar: [
                { id: 'nouns', title: "Nouns", icon: "üî°" },
                { id: 'verbs', title: "Verbs", icon: "üèÉ" },
                { id: 'tenses', title: "Tenses", icon: "‚è≥" },
                { id: 'adjectives', title: "Adjectives", icon: "üé®" },
                { id: 'prepositions', title: "Prepositions", icon: "üìç" },
                { id: 'voice', title: "Active & Passive Voice", icon: "üîÑ" },
                { id: 'speech', title: "Direct & Indirect Speech", icon: "üí¨" }
            ],
            vocabulary: [
                { id: 'synonyms', title: "Synonyms", icon: "üìñ", active: true },
                { id: 'antonyms', title: "Antonyms", icon: "üåì" },
                { id: 'substitution', title: "One Word Substitution", icon: "1Ô∏è‚É£" },
                { id: 'idioms', title: "Idioms & Phrases", icon: "üé≠" }
            ]
        };

        // --- FLASHCARD MEMORY LOGIC ---
        const FLASHCARD_KEY = 'prepease_flashcards_v1';

        function getFlashcardProgress() {
            return JSON.parse(localStorage.getItem(FLASHCARD_KEY) || '{}');
        }

        function saveFlashcardProgress(word, difficulty) {
            const progress = getFlashcardProgress();
            const now = Date.now();
            let nextReview = now;

            if (difficulty === 'good') nextReview += (1 * 24 * 60 * 60 * 1000);
            else if (difficulty === 'easy') nextReview += (3 * 24 * 60 * 60 * 1000);

            progress[word] = { nextReview, difficulty, lastReviewed: now };
            localStorage.setItem(FLASHCARD_KEY, JSON.stringify(progress));
        }

        function getDueCount() {
            const progress = getFlashcardProgress();
            const now = Date.now();
            return Object.values(progress).filter(p => p.nextReview <= now).length;
        }

        // --- CORE NAVIGATION ---
        window.showView = (viewName, params = {}) => {
            currentView = viewName;
            const pages = ['landing-page', 'dashboard-page', 'category-select-page', 'topic-select-page', 'synonyms-levels-page', 'level-page'];
            pages.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.classList.add('hidden');
            });

            const target = document.getElementById(viewName + '-page');
            if (target) {
                target.classList.remove('hidden');
                if (viewName === 'topic-select') {
                    if (params.category) currentCategory = params.category;
                    renderTopicsGrid();
                }
                if (viewName === 'synonyms-levels') {
                    if (params.topic) currentTopic = params.topic;
                    renderLevelsGrid();
                }
                if (viewName === 'dashboard') updateDashboardHeader();
            }
            window.scrollTo(0, 0);
        };

        window.onload = async () => {
            await signInAnonymously(auth);
            onAuthStateChanged(auth, async (u) => {
                user = u;
                if (user) await fetchUserProfile();
                showView('landing');
            });
        };

        async function fetchUserProfile() {
            if (!user) return;
            const userDoc = doc(db, 'artifacts', appId, 'users', user.uid, 'profile', 'data');
            const snap = await getDoc(userDoc);
            if (snap.exists()) {
                userProfile = { ...userProfile, ...snap.data() };
            } else {
                await setDoc(userDoc, userProfile);
            }
        }

        function updateDashboardHeader() {
            const count = (userProfile.completedLevels['synonyms'] || []).length;
            const due = getDueCount();
            const pct = Math.round((count / 10) * 100);
            
            document.getElementById('due-count-text').innerText = due > 0 
                ? `You have ${due} cards ready for review.` 
                : "Your memory list is currently up to date.";
            
            document.getElementById('progress-pct').innerText = `${pct}%`;
            document.getElementById('progress-circle').style.strokeDashoffset = 440 - (440 * (count/10));
        }

        function renderTopicsGrid() {
            const grid = document.getElementById('topics-grid');
            document.getElementById('topic-title').innerText = currentCategory.charAt(0).toUpperCase() + currentCategory.slice(1);
            grid.innerHTML = CATEGORY_TOPICS[currentCategory].map(topic => {
                const isComingSoon = currentCategory === 'grammar' || topic.id !== 'synonyms';
                return `
                    <div onclick="${isComingSoon ? `showMessage('Soon!')` : `showView('synonyms-levels', { topic: '${topic.id}' })`}" 
                         class="group p-10 bg-white border border-slate-100 rounded-[3rem] shadow-xl cursor-pointer transition-all relative ${isComingSoon ? 'opacity-60' : ''}">
                        <div class="text-4xl mb-6">${topic.icon}</div>
                        <h4 class="text-2xl font-bold text-slate-900">${topic.title}</h4>
                        ${isComingSoon ? '<span class="absolute top-6 right-6 text-[10px] font-bold bg-slate-100 px-3 py-1 rounded-full uppercase">Soon</span>' : ''}
                    </div>
                `;
            }).join('');
        }

        function renderLevelsGrid() {
            const grid = document.getElementById('levels-grid');
            document.getElementById('level-selection-title').innerText = `Synonyms: Level 1 - 10`;
            const unlocked = userProfile.completedLevels[currentTopic] || [1];

            grid.innerHTML = Array.from({ length: 10 }, (_, i) => i + 1).map(id => {
                const isUnlocked = unlocked.includes(id) || id === 1;
                
                if (id === 1) {
                    return `
                        <button onclick="loadSynonymsLevel1()" 
                             class="p-10 bg-white border border-sky-100 shadow-xl rounded-[2.5rem] cursor-pointer group transition-all text-left">
                            <div class="w-14 h-14 bg-sky-500 shadow-lg shadow-sky-100 rounded-2xl flex items-center justify-center text-white text-xl font-bold mb-6 group-hover:rotate-6 transition-all">1</div>
                            <h4 class="text-2xl font-bold text-slate-900">Level 1</h4>
                            <p class="text-slate-400 text-sm mt-2">Open Study Hub</p>
                        </button>
                    `;
                }

                return `
                    <div onclick="${isUnlocked ? `loadLevel('${currentTopic}', ${id})` : 'showMessage(\'Locked\')'}" 
                         class="p-10 bg-white border ${isUnlocked ? 'border-sky-100 shadow-xl' : 'border-slate-100 level-locked'} rounded-[2.5rem] cursor-pointer group transition-all">
                        <div class="w-14 h-14 ${isUnlocked ? 'bg-sky-500 shadow-lg shadow-sky-100' : 'bg-slate-200'} rounded-2xl flex items-center justify-center text-white text-xl font-bold mb-6 group-hover:rotate-6 transition-all">${id}</div>
                        <h4 class="text-2xl font-bold ${isUnlocked ? 'text-slate-900' : 'text-slate-400'}">Level ${id} ${!isUnlocked ? 'üîí' : ''}</h4>
                        <p class="text-slate-400 text-sm mt-2">${isUnlocked ? 'Available' : 'Complete previous'}</p>
                    </div>
                `;
            }).join('');
        }

        window.loadLevel = async (topicId, levelId) => {
            const container = document.getElementById('level-page');
            showView('level');
            container.innerHTML = `<div class="flex items-center justify-center min-h-[50vh] animate-pulse"><div class="w-12 h-12 border-4 border-sky-500 border-t-transparent rounded-full animate-spin"></div></div>`;
            try {
                // Topic path building logic - FIXED FILE NAME WITH HYPHEN
                const response = await fetch(`${CONTENT_BASE}${topicId}/level-${levelId}.json`);
                if (!response.ok) throw new Error("File not found");
                activeLevelData = await response.json();
                renderNotes(topicId, levelId);
            } catch (err) {
                container.innerHTML = `<div class="p-20 text-center text-slate-400"><h2>Level ${levelId} Data coming soon.</h2><button onclick="showView('synonyms-levels')" class="mt-4 text-sky-500 underline">Back to Levels</button></div>`;
            }
        };

        function renderNotes(topicId, levelId) {
            const container = document.getElementById('level-page');
            container.innerHTML = `
                <div class="max-w-4xl mx-auto px-6 py-16 animate-page">
                    <div class="flex justify-between items-center mb-8">
                        <button onclick="showView('synonyms-levels')" class="text-slate-400 font-bold flex items-center gap-2">‚Üê Back</button>
                    </div>
                    <h2 class="text-5xl font-extrabold text-slate-900 mb-12 tracking-tighter">Bilingual Notes</h2>
                    <div id="notes-list" class="grid gap-12 mb-16">
                        ${activeLevelData ? activeLevelData.map(v => `
                            <div class="group bg-white p-10 md:p-14 rounded-[4rem] border border-slate-100 shadow-xl flex items-center gap-10">
                                <div class="text-7xl group-hover:scale-110 transition-all">${v.emoji || 'üìñ'}</div>
                                <div class="flex-1">
                                    <h3 class="text-4xl font-extrabold text-slate-900 mb-2">${v.word}</h3>
                                    <p class="text-3xl font-bold text-sky-500 mb-6 font-kannada">${v.meaning_kannada || ''}</p>
                                    <p class="font-bold text-slate-900 text-lg italic">"${v.meaning_english || ''}"</p>
                                </div>
                            </div>
                        `).join('') : '<p class="p-10 text-center text-slate-400">Loading notes...</p>'}
                    </div>
                    <div class="p-12 bg-slate-900 rounded-[4rem] text-center">
                        <h3 class="text-3xl font-bold text-white mb-8">Ready for Memory Review?</h3>
                        <div class="flex flex-col sm:flex-row justify-center gap-6">
                            <button onclick="startFlashcardSession(${levelId})" class="px-12 py-5 bg-white text-slate-900 font-extrabold rounded-3xl hover:scale-105 transition-all">Review Flashcards üÉè</button>
                            <button onclick="renderQuiz(${levelId})" class="px-12 py-5 bg-sky-500 text-white font-extrabold rounded-3xl hover:bg-sky-600 transition-all">Begin Quiz üìù</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- USER REQUESTED UTILITY FUNCTION ---
        window.loadSynonymsLevel1 = () => {
            showView('level');
            const container = document.getElementById('level-page');
            container.innerHTML = `
                <div class="max-w-4xl mx-auto px-6 py-16 animate-page">
                    <div class="flex justify-between items-center mb-8">
                        <button onclick="showView('synonyms-levels')" class="text-slate-400 font-bold flex items-center gap-2">‚Üê Back</button>
                    </div>
                    <h2 class="text-5xl font-extrabold text-slate-900 mb-12 tracking-tighter">Level 1: Foundation</h2>
                    <div id="notes-list" class="grid gap-12 mb-16">
                        <p class="animate-pulse p-10 text-center text-slate-400">Fetching level data...</p>
                    </div>
                </div>
            `;

            // FIXED FILE NAME WITH HYPHEN
            fetch(CONTENT_BASE + "synonyms/level-1.json")
                .then(res => res.json())
                .then(data => {
                    const notesContainer = document.getElementById("notes-list");
                    if (!notesContainer) return;
                    notesContainer.innerHTML = "";
                    const notes = Array.isArray(data) ? data : (data.notes || []);
                    activeLevelData = notes; 

                    notes.forEach(note => {
                        notesContainer.innerHTML += `
                          <div class="p-8 border-2 border-slate-50 rounded-3xl bg-white shadow-sm mb-6 transition-all hover:shadow-md">
                            <h3 class="text-3xl font-extrabold text-slate-900 flex items-center gap-4">
                              ${note.word} <span class="text-4xl">${note.emoji || ""}</span>
                            </h3>
                            <p class="mt-4 text-slate-700 font-medium text-lg leading-relaxed">
                                <span class="text-sky-500 font-bold uppercase text-xs block mb-1">Synonyms / English</span>
                                ${note.meaning_english || ""}
                            </p>
                            <p class="text-xl font-bold text-slate-600 mt-4 font-kannada">
                              ‡≤ï‡≤®‡≥ç‡≤®‡≤°: ${note.meaning_kannada || ""}
                            </p>
                            <p class="italic text-sm mt-4 text-slate-400 bg-slate-50 p-4 rounded-xl">
                              Example: Used in FDA/SDA previous year patterns.
                            </p>
                          </div>
                        `;
                    });
                    
                    const rootContainer = container.querySelector('.max-w-4xl');
                    const actionPanel = document.createElement('div');
                    actionPanel.className = "p-12 bg-slate-900 rounded-[4rem] text-center mt-12";
                    actionPanel.innerHTML = `
                        <h3 class="text-3xl font-bold text-white mb-8">Ready for Memory Review?</h3>
                        <div class="flex flex-col sm:flex-row justify-center gap-6">
                            <button onclick="startFlashcardSession(1)" class="px-12 py-5 bg-white text-slate-900 font-extrabold rounded-3xl hover:scale-105 transition-all">Review Flashcards üÉè</button>
                            <button onclick="renderQuiz(1)" class="px-12 py-5 bg-sky-500 text-white font-extrabold rounded-3xl hover:bg-sky-600 transition-all">Begin Quiz üìù</button>
                        </div>
                    `;
                    rootContainer.appendChild(actionPanel);
                })
                .catch((err) => {
                    console.error("Quick Load Error:", err);
                    const notesContainer = document.getElementById("notes-list");
                    if (notesContainer) notesContainer.innerHTML = "<p class='p-10 text-center text-slate-400'>Notes coming soon.</p>";
                });
        };

        window.startFlashcardSession = (levelId) => {
            const progress = getFlashcardProgress();
            const now = Date.now();
            flashcardSession = {
                levelId,
                currentIdx: 0,
                words: activeLevelData.filter(w => !progress[w.word] || progress[w.word].nextReview <= now)
            };
            
            if (flashcardSession.words.length === 0) {
                showMessage("üéâ Level memorized! Take the quiz.");
                return;
            }
            renderFlashcardUI();
        };

        function renderFlashcardUI() {
            const container = document.getElementById('level-page');
            const data = flashcardSession.words[flashcardSession.currentIdx];
            container.innerHTML = `
                <div class="max-w-4xl mx-auto px-6 py-16 animate-page flex flex-col items-center">
                    <div class="w-full flex justify-between items-center mb-12">
                        <button onclick="loadLevel('synonyms', ${flashcardSession.levelId})" class="text-slate-400 font-bold">‚Üê Stop</button>
                        <p class="text-xs font-bold text-slate-400 uppercase tracking-widest">Card ${flashcardSession.currentIdx+1}/${flashcardSession.words.length}</p>
                        <span class="text-sky-500 font-bold text-xs uppercase">Memory Mode</span>
                    </div>

                    <div class="flashcard-container mb-12">
                        <div id="card-inner" class="flashcard-inner" onclick="this.classList.toggle('is-flipped')">
                            <div class="flashcard-front">
                                <span class="text-8xl mb-8">${data.emoji || 'üìñ'}</span>
                                <h3 class="text-6xl font-extrabold text-slate-900 tracking-tighter">${data.word}</h3>
                                <p class="mt-12 text-slate-300 font-bold uppercase text-[10px]">Click to reveal</p>
                            </div>
                            <div class="flashcard-back text-left items-start justify-start">
                                <h4 class="text-sky-500 font-extrabold text-[10px] uppercase mb-4">English & Kannada Meaning</h4>
                                <p class="text-2xl font-bold text-slate-900 mb-2 leading-tight">${data.meaning_english || ''}</p>
                                <p class="text-3xl font-extrabold text-sky-600 mb-8 font-kannada">${data.meaning_kannada || ''}</p>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-4 w-full max-w-md">
                        <button onclick="submitFlashcard('${data.word}', 'hard')" class="p-5 bg-white border-2 border-slate-100 rounded-3xl hover:border-red-200 transition-all group text-center">
                            <div class="text-2xl mb-1">üò£</div>
                            <div class="text-[10px] font-bold text-slate-400 uppercase group-hover:text-red-500">Hard</div>
                        </button>
                        <button onclick="submitFlashcard('${data.word}', 'good')" class="p-5 bg-white border-2 border-slate-100 rounded-3xl hover:border-sky-200 transition-all group text-center">
                            <div class="text-2xl mb-1">üòê</div>
                            <div class="text-[10px] font-bold text-slate-400 uppercase group-hover:text-sky-500">Good</div>
                        </button>
                        <button onclick="submitFlashcard('${data.word}', 'easy')" class="p-5 bg-white border-2 border-slate-100 rounded-3xl hover:border-emerald-200 transition-all group text-center">
                            <div class="text-2xl mb-1">üòÑ</div>
                            <div class="text-[10px] font-bold text-slate-400 uppercase group-hover:text-emerald-500">Easy</div>
                        </button>
                    </div>
                </div>
            `;
        }

        window.submitFlashcard = (word, diff) => {
            saveFlashcardProgress(word, diff);
            flashcardSession.currentIdx++;
            if (flashcardSession.currentIdx < flashcardSession.words.length) renderFlashcardUI();
            else loadLevel('synonyms', flashcardSession.levelId);
        };

        window.renderQuiz = (id) => showMessage("Evaluation engine ready.");
        window.showMessage = (msg) => {
            const el = document.getElementById('ui-message');
            el.innerText = msg; el.classList.remove('hidden');
            setTimeout(() => el.classList.add('hidden'), 4000);
        };
    </script>
</body>
</html>
